{% assign imports = false %}{% if page.imports %}{% assign imports = page.imports %}{% elsif page.app and page.app != "" and site.data.apps[page.app].imports %}{% assign imports = site.data.apps[page.app].imports %}{% endif %}
{% if imports %}

	{% assign sync_imports = imports | where_exp: "item", "item.load == 'sync'" | map: "name" %}
  {% if sync_imports %}
		{% for import in sync_imports %}
			{% if jekyll.environment == "debug" %}
				{% for import_script in site.data.imports[import].dev %}
					<script src="{{ import_script.url }}"{% if import_script.integrity %} integrity="{{ import_script.integrity }}"{% endif %}{% if import_script.crossorigin %} crossorigin="{{ import_script.crossorigin }}"{% endif %}></script>
				{% endfor %}
			{% else %}
				{% for import_script in site.data.imports[import].prod %}
					<script src="{{ import_script.url }}"{% if import_script.integrity %} integrity="{{ import_script.integrity }}"{% endif %}{% if import_script.crossorigin %} crossorigin="{{ import_script.crossorigin }}"{% endif %}{% if import_script.defer %} defer{% endif %}{% if import_script.async %} async{% endif %}></script>
				{% endfor %}
			{% endif %}
		{% endfor %}
	{% endif %}

	{% for font in site.data.fonts %}{% if forloop.first %}{% assign fonts = fonts | append: font[1].safe | append: ":" | append: font[1].weights %}{% else %}{% assign fonts = fonts | append: "|" | append: font[1].safe | append: ":" | append: font[1].weights %}{% endif %}{% endfor %}
	<script type="text/javascript" charset="utf-8" data-src="imports">
		{% assign first_imports = imports | where_exp: "item", "item.load == 'first'" | map: "name" %}{% assign last_imports = imports | where_exp: "item", "item.load == 'last'" | map: "name" %}{% assign after_imports = imports | where_exp: "item", "item.load == 'after'" | map: "name" %}
		
		var LOAD_FIRST = [{ url : "https://fonts.googleapis.com/css?family={{ fonts }}" }{% if first_imports and first_imports.size > 0 %},{% for import in first_imports %}{% if jekyll.environment == "debug" %}{% for import_url in site.data.imports[import].dev %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% else %}{% for import_url in site.data.imports[import].prod %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% endif %}{% endfor %}{% endif %}];
		
		{% if last_imports and last_imports.size > 0 %}var LOAD_LAST = [{% for import in last_imports %}{% if jekyll.environment == "debug" %}{% for import_url in site.data.imports[import].dev %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% else %}{% for import_url in site.data.imports[import].prod %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% endif %}{% endfor %}];{% endif %}
		
		{% if after_imports and after_imports.size > 0 %}var LOAD_AFTER = [{% for import in after_imports %}{% if jekyll.environment == "debug" %}{% for import_url in site.data.imports[import].dev %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% else %}{% for import_url in site.data.imports[import].prod %} { id: "{{ import_url.id }}", url : "{{ import_url.url }}"{% if import_url.mode %}, mode : "{{ import_url.mode }}"{% endif %} },{% endfor %}{% endif %}{% endfor %}];{% endif %}
		
	</script>

{% else %}
	<script type="text/javascript" charset="utf-8" data-src="imports">
	
		var LOAD_AFTER = [{url : "https://fonts.googleapis.com/css?family={{ fonts }}"}];

	</script>

{% endif %}

<noscript>
	<link rel="stylesheet" href="//fonts.googleapis.com/css?family={{ fonts }}">
	{% if imports %}
		{% for import in imports %}
			{% if site.data.imports[import.name].type == "css" %}
				{% if jekyll.environment == "debug" %}
					{% for import_css in site.data.imports[import.name].dev %}
						<link rel="stylesheet" href="{{ import_css.url }}"{% if import_css.integrity %} integrity="{{ import_css.integrity }}"{% endif %}{% if import_css.crossorigin %} crossorigin="{{ import_css.crossorigin }}"{% endif %} />
					{% endfor %}
				{% else %}
					{% for import_css in site.data.imports[import.name].prod %}
						<link rel="stylesheet" href="{{ import_css.url }}"{% if import_css.integrity %} integrity="{{ import_css.integrity }}"{% endif %}{% if import_css.crossorigin %} crossorigin="{{ import_css.crossorigin }}"{% endif %} />
					{% endfor %}
				{% endif %}
			{% endif %}
		{% endfor %}
	{% endif %}
</noscript>